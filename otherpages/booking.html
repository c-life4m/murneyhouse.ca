<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Murney House - Your home away from home">
    <title>Murney House - Booking</title>
    <link rel="icon" type="image/svg+xml" href="../public/images/assets/icons/favicon.png?v=1">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="../public/images/assets/FONTS/fontawesome/css/all.min.css">

    <!-- FullCalendar CSS -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css' rel='stylesheet' />

    <!-- Main CSS -->
    <link rel="stylesheet" href="../src/styles/style.css">

    <style>

        #hero.booking-hero {
            position: relative;
            width: 100%;
            height: 50vh;      /* only half the viewport tall */
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

         .booking-hero-content {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;           /* your responsive padding */
            max-width: 800px;     /* stop it growing too wide */
            display: flex;        /* stack children vertically */
            flex-direction: column;
            align-items: center;  /* center text & children */
            text-align: center;
            box-sizing: border-box;
        }


            .booking-hero-content h1 {
            margin: 0 0 var(--spacing-md);
            animation: flyInFromLeft 1s ease-out forwards;
        }

        .booking-hero-content p {
            margin: 0 auto;
            animation: flyInFromRight 1s ease-out 0.3s both;
        }

        @keyframes flyInFromLeft {
            0% {
                opacity: 0;
                transform: translateX(-300px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes flyInFromRight {
            0% {
                opacity: 0;
                transform: translateX(300px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* ─── Card & Animation (Houses Rules, Requirements & Disclaimers) ─── */
            .rules-card {
            background-color: var(--light-card);
            padding: 3rem;                    /* adjust as needed */
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            max-width: 800px;
            margin: 3rem auto;                /* center + spacing from other sections */
            animation: fadeInUp 1s ease-out both;
            }

            body.dark-mode .rules-card {
            background-color: var(--dark-card);
            }

            .rules-list,
            .requirements-list,
            .disclaimers-list {
            list-style: none;
            padding: 0;
            margin: 0;
            }

            .rules-list li,
            .requirements-list li,
            .disclaimers-list li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;              /* one blank line between bullets */
            }

            .rules-list li:last-child,
            .requirements-list li:last-child,
            .disclaimers-list li:last-child {
            margin-bottom: 0;
            }

            .rules-list li i,
            .requirements-list li i,
            .disclaimers-list li i {
            flex-shrink: 0;
            font-size: 1.25rem;
            color: var(--cta);                      /* or your primary color */
            margin-right: 2ch;                /* two character spaces */
            }

            /* Fade-in from below */
            @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .booking-section {
            padding: 60px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .booking-section h2 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.5rem;
            color: var(--text-primary);
        }

        .rules-list, .requirements-list, .disclaimers-list {
            list-style: none;
            padding: 0;
            max-width: 800px;
            margin: 0 auto;
        }

        .rules-list li, .disclaimers-list li {
            background: var(--card-background);
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--accent-color);
            box-shadow: var(--shadow-light);
        }

        .requirements-list li {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        /* Align icons with headings */
        .requirement-item {
            display: flex;
            align-items: flex-start;
        }

        .cancellation-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .cancellation-info ul {
            padding-left: 20px;
            margin-top: 10px;
            margin-left: 30px;
        }

        .room-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .room-card {
            background: var(--card-background);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            transition: transform 0.3s ease;
            position: relative; /* Ensure the overlay is positioned correctly */
        }

        .room-card:hover {
            transform: translateY(-5px);
        }

        .room-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .room-card-content {
            padding: 20px;
        }

        /* New Room Selection Overlay */
        .room-selection-overlay {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.0);
            padding: 5px;
            border-radius: 5px;
            z-index: 10; /* Ensure it's above the image */
        }

        .room-selection-overlay input[type="checkbox"] {
            margin-right: 8.5px; /* Reduced space by 50% */
            width: 25px; /* Increased size */
            height: 25px; /* Increased size */
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 1.5); /* Add black drop shadow */
        }

        .room-selection-overlay input[type="number"] {
            width: 50px;
            margin: 0 2.5px; /* Reduced space by 50% */
            -moz-appearance: textfield; /* Remove up/down arrows in Firefox */
            appearance: textfield; /* Remove up/down arrows in other browsers */
            color: red !important; /* Make text red and ensure it overrides other styles */
            font-size: 1.5rem; /* Increase font size */
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 1.5); /* Add black drop shadow */
        }

        .room-selection-overlay input[type="number"]::-webkit-outer-spin-button,
        .room-selection-overlay input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none; /* Remove up/down arrows in Chrome, Safari, Edge, Opera */
            margin: 0; /* Remove default margin */
        }

        .room-selection-overlay label {
            margin-right: 1.5px; /* Reduced space by 50% */
            color: red !important;
            font-size: 1.6rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 1.5); /* Add black drop shadow */
        }

        /* Adjust the room details to be closer to the image */
        .room-details {
            padding: 10px; /* Reduced padding */
        }

        .room-details h4 {
            margin-top: 10px; /* Reduced margin */
            font-size: 1.4rem; /* Slightly reduced font size */
        }

        .room-details p {
            margin-top: 5px; /* Reduced margin */
            font-size: 1.2rem;
        }

        /* Ensure the room image container is positioned correctly */
        .room-image {
            position: relative;
            height: 100px;
            overflow: hidden;
        }

        .room-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-medium);
        }

        .room-card:hover .room-image img {
            transform: scale(1.1);
        }

        .calendar-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .calendar-content {
            background: var(--card-background);
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
            color: white;
        }

        /* Calendar specific text styling */
        .calendar-content h2,
        .calendar-content h3,
        .calendar-content h4 {
            color: white !important;
        }

        .fc-bg-event.booked {
            background-color: red !important;
            opacity: 1
        }
        .fc-bg-event.pending {
            background-color: orange !important;
            opacity: 1
        }
        .fc-bg-event.available {
            background-color: green !important;
            opacity: 1
        }

        /* FullCalendar date numbers */
        .fc-daygrid-day-number {
            color: white !important;
            font-weight: 500;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 1.5);
        }

        /* FullCalendar headers (day names) */
        .fc-col-header-cell {
            color: white !important;
        }

        /* FullCalendar toolbar (month/year title and navigation) */
        .fc-toolbar-title {
            color: white !important;
        }

        .booking-form {
            display: none;
            background: var(--card-background);
            padding: 40px;
            border-radius: 15px;
            margin-top: 40px;
            box-shadow: var(--shadow-medium);
        }

        .booking-form h2 {
            text-align: center;
            margin-bottom: 20px; /* Optional: Add some space below the title */
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--input-background);
            color: var(--text-primary);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .room-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .room-option {
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .room-option.selected {
            border-color: var(--accent-color);
            background: var(--accent-light);
        }

        .room-option img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .room-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .room-header input[type="checkbox"] {
            margin-right: 5px;
        }

        .room-header input[type="number"] {
            width: 50px;
            margin: 0 5px;
        }

        .price-summary {
            background: var(--accent-light);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .addon-services {
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .addon-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .addon-item:last-child {
            border-bottom: none;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
        }

        .close-modal {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .close-modal:hover {
            color: var(--text-primary);
        }

        .submit-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }

        .privacy-notice {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 20px;
            padding: 15px;
            background: var(--card-background);
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .popup-content {
            background: var(--card-background);
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }


        .booking-button-container {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .room-selection-container {
            padding: 15px;
            background: var(--dark-background);
            border-radius: 8px;
            border: 1px solid var(--light-border);
            text-align: center;
        }

        .room-selection-container h4 {
            color: white; /* Make the "Select Your Room Choices:" title white */
            margin-bottom: 15px;
        }

        .room-checkboxes {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .room-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border: 1px solid var(--light-border);
            border-radius: 6px;
            transition: all 0.3s ease;
            color: white;
        }

        .room-checkbox:hover {
            background: var(--cta);
            color: white;
        }

        .room-checkbox input {
            margin-right: 8px;
        }

        .room-checkbox input:checked + span {
            font-weight: 600;
        }

        .multi-room-btn {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border: 1px solid var(--light-border);
            border-radius: 6px;
            transition: all 0.3s ease;
            color: white;
            background: transparent;
            font-size: 1rem;
            margin-left: 0; /* Remove if you want spacing between buttons */
            margin-right: 0;
            margin-top: 0;
            margin-bottom: 0;
        }

        .multi-room-btn:hover,
        .multi-room-btn.active {
            background: var(--cta);
            color: white;
            font-weight: 600;
        }

        .multi-room-btn.active {
            background: orange; /* Or use your orange variable */
            color: white;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .room-selection {
                grid-template-columns: 1fr;
            }

            .booking-section {
                padding: 40px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Header with navigation -->
    <header>
        <div class="logo">
            <a href="../index.html">Murney House</a>
        </div>
        <nav>
            <div class="desktop-nav">
                <ul>
                    <li><a href="rooms.html">Rooms</a></li>
                    <li><a href="amenities.html">Amenities</a></li>
                    <li><a href="../index.html#local-area">Local Area</a></li>
                    <li><a href="guest-hub.html">Guest Hub</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
            <div class="mobile-nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="mobile-nav">
                <ul>
                    <li><a href="../index.html">Back to Home</a></li>
                    <li class="nav-item"><a href="rooms.html">Rooms</a></li>
                    <li class="nav-item"><a href="amenities.html">Amenities</a></li>
                    <li class="nav-item"><a href="../index.html#local-area" class="nav-link">Local Area</a></li>
                    <li class="nav-item"><a href="guest-hub.html" class="nav-link">Guest Hub</a></li>
                    <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
                </ul>
            </div>
        </nav>
        <div class="header-controls">
            <button class="theme-toggle" aria-label="Toggle dark mode">
                <svg class="sun-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/>
                    <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2"/>
                    <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2"/>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2"/>
                    <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2"/>
                    <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2"/>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2"/>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2"/>
                </svg>
                <svg class="moon-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>
        </div>
    </header>

    <!-- Booking Hero Section -->
    <section id="hero" class="booking-hero">
        <div class="booking-hero-background hero-image"></div>
        <div class="booking-hero-content">
            <h1>Booking Page</h1>
            <p>Please review the house rules, booking requirements, disclaimers & warnings before continuing on to booking.</p>
        </div>
    </section>

    <!-- House Rules Section -->
    <section class="booking-section rules-card">
        <h2>House Rules</h2>
        <ul class="rules-list">
            <li><i class="fas fa-smoking-ban"></i> No smoking/vaping on the property.</li>
            <li><i class="fas fa-volume-down"></i> No loud noises after 10pm.</li>
            <li><i class="fas fa-clock"></i> Check-in after 3pm / checkout before 12pm (noon).</li>
            <li><i class="fas fa-shoe-prints"></i> Take shoes off at the door.</li>
            <li><i class="fas fa-wifi"></i> You must agree not to use our internet for anything illegal.</li>
            <li><i class="fas fa-music"></i> Bedroom 3 ("Party Room") is the only room for louder music, partying, dancing, etc. The rest of the house is for quieter enjoyment.</li>
            <li><i class="fas fa-question-circle"></i> Special needs/requests? Check with us in advance.</li>
            <li><i class="fas fa-book"></i> Familiarize yourself with all appliances/gadgets (see Guest Hub page for instructions) before use — it's your responsibility.</li>
        </ul>
    </section>

    <!-- Booking Requirements Section -->
    <section class="booking-section rules-card">
        <h2>Booking Requirements</h2>
        <ul class="requirements-list">
            <li>
                <div class="requirement-item">
                    <i class="fas fa-credit-card"></i> Primary renter must have a current credit score of 800+, or provide a recent credit card bill showing a $30,000+ credit limit, or (if neither is available) a refundable security deposit of at least $1,000 (amount may increase with the number of guests/days).
                </div>
            </li>
            <li>
                <div class="requirement-item">
                    <i class="fas fa-money-check"></i> 50% of rental fee required to confirm booking (Interac transfer only at this time).
                </div>
            </li>
            <li>
                <div class="requirement-item">
                    <i class="fas fa-undo"></i> <strong>Cancellations & Refunds:</strong>
                </div>
                <div class="cancellation-info">
                    <ul style="padding-left: 20px;">
                        <li>100% if cancelled ≥24hrs before check-in (12pm)</li>
                        <li>50% if cancelled ≥12hrs before</li>
                        <li>25% if cancelled ≥6hrs before</li>
                        <li>No refund <6hrs or for no-shows</li>
                    </ul>
                </div>
            </li>
        </ul>
    </section>

    <!-- Disclaimers & Warnings Section -->
    <section class="booking-section rules-card">
        <h2>Disclaimers & Warnings</h2>
        <ul class="disclaimers-list">
            <li><i class="fas fa-exclamation-triangle"></i> Use of gadgets, appliances, cookware, and utensils is at your own risk.</li>
            <li><i class="fas fa-exclamation-triangle"></i> Some common area floors are polished porcelain tile - can be slippery when wet or if wearing socks.</li>
        </ul>
    </section>

    <!-- Request Booking Section -->
    <section class="booking-section">
        <h2>Request Booking</h2>
        <div class="room-cards">
            <div class="room-card">
                <img src="../public/images/assets/PX/Brm-1A-800.webp" alt="Room 1" onerror="this.src='../public/images/assets/PX/placeholder.jpg'">
                <div class="room-card-content">
                    <h3>Room 1</h3>
                    <p>Double bed. 1-2 Guests, large window, morning sun and view of front yard.</p>
                    <button class="cta-button" onclick="openCalendar('Room 1')">Select Your Days</button>
                </div>
            </div>
            <div class="room-card">
                <img src="../public/images/assets/PX/Brm-2A-800.webp" alt="Room 2" onerror="this.src='../public/images/assets/PX/placeholder.jpg'">
                <div class="room-card-content">
                    <h3>Room 2</h3>
                    <p>2 stacked twin beds. 1-2 Guests. Large window overlooking a green side yard.</p>
                    <button class="cta-button" onclick="openCalendar('Room 2')">Select Your Days</button>
                </div>
            </div>
            <div class="room-card">
                <img src="../public/images/assets/PX/Brm-3A-800.webp" alt="Room 3 - Party Room" onerror="this.src='../public/images/assets/PX/placeholder.jpg'">
                <div class="room-card-content">
                    <h3>Room 3 - Party</h3>
                    <p>Sleeps up to 4, can also be used for louder music, parties and gatherings.</p>
                    <button class="cta-button" onclick="openCalendar('Room 3')">Select Your Days</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Calendar Modal -->
    <div id="calendarModal" class="calendar-modal">
        <div class="calendar-content">
            <span class="close-modal" onclick="closeCalendar()">&times;</span>
            <h3 id="calendarTitle">Select Your Days</h3>
            <div id="calendar"></div>
            <div style="margin-top: 20px;">
                <p><span style="color: green;">■</span> Available <span style="color: orange;">■</span> Pending <span style="color: red;">■</span> Booked / Unavailable</p>
                <div class="booking-button-container">
                <button id="proceedToBooking" type="button" onclick="proceedToBooking()" style="display: none;" class="cta-button large">Proceed to Booking Form</button>
            </div>
        </div>
            <!-- Room Selection -->
            <div class="room-selection-container" style="margin-bottom: 20px;">
                <h4>Select Your Room Choices:</h4>
                <div class="room-checkboxes">
                    <label class="room-checkbox">
                        <input type="checkbox" class="room-select" value="Room 1">
                        <span>Room 1</span>
                    </label>
                    <label class="room-checkbox">
                        <input type="checkbox" class="room-select" value="Room 2">
                        <span>Room 2</span>
                    </label>
                    <label class="room-checkbox">
                        <input type="checkbox" class="room-select" value="Room 3">
                        <span>Room 3</span>
                    </label>
                    <!-- Multi-room buttons -->
                    <button type="button" class="multi-room-btn" data-rooms="Room 1,Room 2">Rooms 1+2</button>
                    <button type="button" class="multi-room-btn" data-rooms="Room 1,Room 2,Room 3">Rooms 1+2+3</button>
                </div>
            </div>

            <!-- Booking Request Form -->
            <div id="bookingForm" class="booking-form">
                <h2>Booking Request Form</h2>
                <form id="bookingRequestForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone *</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="creditScore">Current Credit Score (Optional)</label>
                        <input type="number" id="creditScore" name="creditScore" min="300" max="950">
                    </div>

                    <div class="form-group">
                        <label for="guestCount">Number of Guests (up to 6) *</label>
                        <select id="guestCount" name="guestCount" required onchange="updateGuestDetails()">
                            <option value="">Select number of guests</option>
                            <option value="1">1 Guest</option>
                            <option value="2">2 Guests</option>
                            <option value="3">3 Guests</option>
                            <option value="4">4 Guests</option>
                            <option value="5">5 Guests</option>
                            <option value="6">6 Guests</option>
                        </select>
                    </div>

                    <div id="guestDetails"></div>

                    <div class="form-group">
                        <label>Room Selection *</label>
                        <div class="room-selection">
                            <div class="room-option">
                                <div class="room-image">
                                    <img src="../public/images/assets/PX/Brm-1A-800.webp" alt="Room 1" onerror="this.src='../public/images/assets/PX/Brm-1A-800.webp'">
                                    <div class="room-selection-overlay">
                                        <input type="checkbox" id="room1" name="rooms" value="room1" onchange="updatePriceSummary()">
                                        <label for="room1">x</label>
                                        <input type="number" id="room1Days" name="room1Days" min="1" max="99" value="1" onchange="updatePriceSummary(); onDaysChange(this);" oninput="limitDaysInput(this)" >
                                        <label for="room1Days">days</label>
                                        <!-- Hidden input for Room 1's start date -->
                                        <input type="hidden" id="room1StartDate" name="room1StartDate" value="">
                                    </div>
                                </div>
                                <div class="room-details">
                                    <h4>Room 1</h4>
                                    <p>$129/night</p>
                                </div>
                            </div>
                            <div class="room-option">
                                <div class="room-image">
                                    <img src="../public/images/assets/PX/Brm-2A-800.webp" alt="Room 2" onerror="this.src='../public/images/assets/PX/Brm-2A-800.webp'">
                                    <div class="room-selection-overlay">
                                        <input type="checkbox" id="room2" name="rooms" value="room2" onchange="updatePriceSummary()">
                                        <label for="room2">x</label>
                                        <input type="number" id="room2Days" name="room2Days" min="1" max="99" value="1" onchange="updatePriceSummary(); onDaysChange(this);" oninput="limitDaysInput(this)" >
                                        <label for="room2Days">days</label>
                                        <input type="hidden" id="room2StartDate" name="room2StartDate" value="">
                                    </div>
                                </div>
                                <div class="room-details">
                                    <h4>Room 2</h4>
                                    <p>$99/night</p>
                                </div>
                            </div>
                            <div class="room-option">
                                <div class="room-image">
                                    <img src="../public/images/assets/PX/Brm-3A-800.webp" alt="Room 3" onerror="this.src='../public/images/assets/PX/Brm-3A-800.webp'">
                                    <div class="room-selection-overlay">
                                        <input type="checkbox" id="room3" name="rooms" value="room3" onchange="updatePriceSummary()">
                                        <label for="room3">x</label>
                                        <input type="number" id="room3Days" name="room3Days" min="1" max="99" value="1" onchange="updatePriceSummary(); onDaysChange(this);" oninput="limitDaysInput(this)" >
                                        <label for="room3Days">days</label>
                                        <input type="hidden" id="room3StartDate" name="room3StartDate" value="">
                                    </div>
                                </div>
                                <div class="room-details">
                                    <h4>Room 3</h4>
                                    <p>$169/night</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="price-summary">
                        <h3>Price Summary</h3>
                        <div id="priceSummary">
                            <p>Select rooms and dates to see pricing</p>
                        </div>
                    </div>
                </form>

            <div class="addon-services">
                <h3>Add-on Services</h3>
                <div class="addon-item">
                   <!-- Remove this to re-activate Add-on Section
                    <div>
                        <strong>Stock the Fridge</strong>
                        <div style="margin-top: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin: 5px 0;">
                                <span>White Eggs ($1 each)</span>
                                <div class="quantity-control">
                                    <button type="button" class="quantity-btn" onclick="changeQuantity('eggs', -1)">-</button>
                                    <span id="eggs-qty">0</span>
                                    <button type="button" class="quantity-btn" onclick="changeQuantity('eggs', 1)">+</button>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin: 5px 0;">
                                <span>Field Tomatoes ($2 each)</span>
                                <div class="quantity-control">
                                    <button type="button" class="quantity-btn" onclick="changeQuantity('tomatoes', -1)">-</button>
                                    <span id="tomatoes-qty">0</span>
                                    <button type="button" class="quantity-btn" onclick="changeQuantity('tomatoes', 1)">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    Remove this to activate ADD-Ons-->
                </div>
                <div class="addon-item">
                    <div>
                        <strong>Pick Up At Via Rail Station</strong>
                        <p>$20 for up to 4 guests</p>
                    </div>
                    <input type="checkbox" id="pickup" name="pickup" value="20" onchange="updatePriceSummary()">
                </div>
            </div>

            <div class="form-group">
                <label for="specialRequests">Special Requests (500 character limit)</label>
                <textarea id="specialRequests" name="specialRequests" maxlength="500" rows="4" placeholder="Any special requests or requirements..."></textarea>
                <small id="charCount">0/500 characters</small>
            </div>

            <div class="privacy-notice">
                <strong>Privacy Notice:</strong> Personal information collected is used exclusively for renting our rooms and resolving disputes, not shared except as required by law. All info is encrypted and transmitted via secure HTTPS.
            </div>

            <button type="submit" class="cta-button large">Submit Booking Request</button>
        </form>
    </div>

    <!-- Thank You Popup -->
    <div id="thankYouPopup" class="popup-overlay">
        <div class="popup-content">
            <h2>Request Received!</h2>
            <p>Thank you for your booking request.</p>
            <div id="bookingSummary"></div>
            <p><strong>Your Unique ID: <span id="uniqueId"></span></strong></p>
            <p>A confirmation email has been sent to your email address. If you don't receive confirmation within 24 hours, please follow up with our site admin using your unique ID in the subject line.</p>
            <button onclick="closeThankYou()" class="submit-btn">Close</button>
        </div>
    </div>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-column">
                    <h3>Contact</h3>
                    <address>
                        <p>123 Main Street<br>Belleville, ON, Canada K8P 3N6
                        <p><a href="tel:+15551234567">(555) 123-4567</a></p>
                        <p><a href="mailto:info@murneyhouse.ca">info@murneyhouse.ca</a></p>
                    </address>
                </div>

                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="guest-hub.html">Guest Hub</a></li>
                        <li><a href="amenities.html">Amenities</a></li>
                       <li><a href="rooms.html">Rooms</a></li>
                        <li><a href="booking.html">Policies</a></li>
                        <li><a href="contact.html">FAQs</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 Murney House. All rights reserved.</p>
                <div class="footer-links">
                    <a href="booking.html">Privacy Policy</a>
                    <a href="booking.html">Terms of Service</a>
                    <a href="contact.html">Sitemap</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <script src="../src/script.js"></script>
    <script>
        // Booking page specific JavaScript
        let calendar;
        let selectedDates = [];
        let currentRoom = '';
        let addons = { eggs: 0, tomatoes: 0 };

         // --- Room availability data (add here) ---
        const roomAvailability = {
            "Room 1": {
            booked: ["2025-06-30", "2025-07-01" ],
            pending: ["2025-07-03", "2025-07-04"]
            },

            "Room 2": {
            booked: ["2025-07-03"],
            pending: [ "2025-07-06"]
            },

            "Room 3": {
            booked: ["2025-07-03"],
            pending:[ "2025-07-04"]
            }
        };

        // Set responsive background image for booking hero
        function setBookingHeroBackground() {
            const heroBackground = document.querySelector('.booking-hero-background');
            const width = window.innerWidth;

            let imagePath;
            if (width >= 1200) {
                imagePath = '../public/images/assets/PX/hero-1920.webp';
            } else if (width >= 768) {
                imagePath = '../public/images/assets/PX/hero-1200.webp';
            } else {
                imagePath = '../public/images/assets/PX/hero-800.webp';
            }

            heroBackground.style.backgroundImage = `url('${imagePath}')`;
        }

        // --- Calendar availability update function (add here) ---
        function updateCalendarAvailability(selectedRooms) {
            // Remove all previous background events (green), booked (red), and pending (orange)
            if (calendar) {
                calendar.getEvents().forEach(event => event.remove());
            }

            if (!selectedRooms.length) return;

            // Gather all booked and pending dates for selected rooms
            const bookedDates = new Set();
            const pendingDates = new Set();

            selectedRooms.forEach(room => {
                const roomData = roomAvailability[room] || {};
                (roomData.booked || []).forEach(date => bookedDates.add(date));
                (roomData.pending || []).forEach(date => pendingDates.add(date));
            });

            // Get all visible days in the current calendar view
            const view = calendar.view;
            const start = new Date(view.currentStart);
            const end = new Date(view.currentEnd);
            for (let d = new Date(start); d < end; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toISOString().split('T')[0];
                if (bookedDates.has(dateStr)) {
                    calendar.addEvent({
                        start: dateStr,
                        display: 'background',
                        classNames: ['booked']
                    });
                } else if (pendingDates.has(dateStr)) {
                    calendar.addEvent({
                        start: dateStr,
                        display: 'background',
                        classNames: ['pending']
                    });
                } else {
                    calendar.addEvent({
                        start: dateStr,
                        display: 'background',
                        classNames: ['available']
                    });
                }
            }
        }

        // Calendar functions
        function openCalendar(roomId) {
            currentRoom = roomId;
            // Uncheck all room checkboxes first
            document.querySelectorAll('.room-checkboxes input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });

            // Check the one matching the roomId
            const targetCheckbox = document.querySelector(`.room-checkboxes input[type="checkbox"][value="${roomId}"]`);
            if (targetCheckbox) {
                targetCheckbox.checked = true;
            }

            document.getElementById('calendarModal').style.display = 'flex';
            document.getElementById('calendarTitle').textContent = formatRoomTitle(roomId);

            // Initialize calendar if not already done
            if (!calendar) {
                initializeCalendar();
            }

        }

        function formatRoomTitle(roomId) {
            // Handles single or multiple room IDs like "bedroom-1", "bedroom-2", "bedroom-1,bedroom-2"
            if (roomId.includes(',')) {
                // Multi-room: split and get numbers
                const numbers = roomId.split(',').map(id => id.match(/\d+/)?.[0]).filter(Boolean);
                return `Room${numbers.length > 1 ? 's' : ''} ${numbers.join(' & ')} - Select Your Days`;
            } else {
                // Single room
                const number = roomId.match(/\d+/)?.[0] || '';
                return `Select Your Days`;
            }
        }

        // 1. Handle checkbox changes (single/multi room selection)
        document.querySelectorAll('.room-select').forEach(cb => {
            cb.addEventListener('change', function() {
                // Gather selected rooms
                const selectedRooms = [];
                document.querySelectorAll('.room-select:checked').forEach(cb => {
                    selectedRooms.push(cb.value);
                });
                updateCalendarAvailability(selectedRooms);
            });
        });

        // 2. Handle multi-room button clicks
        document.querySelectorAll('.multi-room-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Parse rooms from data-rooms attribute
                const rooms = btn.getAttribute('data-rooms').split(',');
                // Set checkboxes to match button selection
                document.querySelectorAll('.room-select').forEach(cb => {
                    cb.checked = rooms.includes(cb.value);
                });
                updateCalendarAvailability(rooms);
            });
        });

        function closeCalendar() {
            document.getElementById('calendarModal').style.display = 'none';
        }

        let firstSelectedDate = null; // Variable to track the first selected date

        function initializeCalendar() {
            const calendarEl = document.getElementById('calendar');
            calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                selectable: true,
                validRange: {
                    start: new Date() // Disable past days
                },
                events: [
                    // Sample events - replace with real data
                    { title: 'Booked', start: '2025-07-15', color: 'red' },
                    { title: 'Pending', start: '2025-07-20', color: 'orange' }
                ],
                // --- MOBILE TOUCH SUPPORT ---
                dateClick: function(info) {
                    const selectedRooms = Array.from(document.querySelectorAll('.room-select:checked')).map(cb => cb.value);
                    const selectedDate = info.dateStr;

                // Block if selectedDate is booked or pending for any selected room
                    let isBlocked = false;
                    selectedRooms.forEach(room => {
                        if (
                            (roomAvailability[room]?.booked || []).includes(selectedDate) ||
                            (roomAvailability[room]?.pending || []).includes(selectedDate)
                        ) {
                            isBlocked = true;
                        }
                    });

                    if (isBlocked) {
                        alert("This date is already booked or pending for the selected room(s). Please choose another date.");
                        return;
                    }

                    // Only handle on touch devices
                    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                        const clickedDate = info.dateStr;

                        // Clear previous selections
                        calendar.getEvents().forEach(event => {
                            if (event.title === 'Selected') {
                                event.remove();
                            }
                        });

                        if (!firstSelectedDate) {
                            // First date selected
                            firstSelectedDate = clickedDate;
                            calendar.addEvent({
                                title: 'Selected',
                                start: clickedDate,
                                end: clickedDate,
                                color: 'orange'
                            });
                        } else {
                            // Second date selected, create range
                            const date1 = firstSelectedDate;
                            const date2 = clickedDate;
                            const rangeStart = date1 <= date2 ? date1 : date2;
                            const rangeEnd = date1 <= date2 ? date2 : date1;

                                // --- Add overlap check here ---
                                let isBlocked = false;
                                let current = new Date(rangeStart);
                                const end = new Date(rangeEnd);
                                const selectedRooms = Array.from(document.querySelectorAll('.room-select:checked')).map(cb => cb.value);
                                while (current <= end) {
                                    const dateStr = current.toISOString().split('T')[0];
                                    selectedRooms.forEach(room => {
                                        if (
                                            (roomAvailability[room]?.booked || []).includes(dateStr) ||
                                            (roomAvailability[room]?.pending || []).includes(dateStr)
                                        ) {
                                            isBlocked = true;
                                        }
                                    });
                                    current.setDate(current.getDate() + 1);
                                }
                                if (isBlocked) {
                                    alert("One or more selected dates are already booked or pending for the selected room(s). Please choose another range.");
                                    firstSelectedDate = null;
                                    return;
                                }
                                // --- End overlap check ---

                            const nextDay = new Date(rangeEnd);
                            nextDay.setDate(nextDay.getDate() + 1);
                            const rangeEndForCalendar = nextDay.toISOString().split('T')[0];

                            calendar.addEvent({
                                title: 'Selected',
                                start: rangeStart,
                                end: rangeEndForCalendar,
                                color: 'orange'
                            });

                            firstSelectedDate = null;
                        }

                        document.getElementById('proceedToBooking').style.display = 'inline-block';
                    }
                },
                // --- END MOBILE TOUCH SUPPORT ---

                datesSet: function(info) {
                    // This runs whenever the visible date range changes (e.g., next/prev month)
                    const selectedRooms = Array.from(document.querySelectorAll('.room-select:checked')).map(cb => cb.value);
                    updateCalendarAvailability(selectedRooms);
                },

                select: function(info) {
                    const selectedRooms = Array.from(document.querySelectorAll('.room-select:checked')).map(cb => cb.value);
                    const startDate = info.startStr;
                    // Don't use endDate at all - it's always the next day

                    // Clear previous selections
                    calendar.getEvents().forEach(event => {
                        if (event.title === 'Selected') {
                            event.remove();
                        }
                    });

                    if (!firstSelectedDate) {
                        // First date selected
                        firstSelectedDate = startDate;
                        calendar.addEvent({
                            title: 'Selected',
                            start: startDate,
                            end: startDate,
                            color: 'orange'
                        });
                    } else {
                        // Second date selected, create range using only startDate
                        const date1 = firstSelectedDate;
                        const date2 = startDate;
                        const rangeStart = date1 <= date2 ? date1 : date2;
                        const rangeEnd = date1 <= date2 ? date2 : date1;

                                // Check for overlap
                                let isBlocked = false;
                                let current = new Date(rangeStart);
                                const end = new Date(rangeEnd);
                                while (current <= end) {
                                    const dateStr = current.toISOString().split('T')[0];
                                    selectedRooms.forEach(room => {
                                        if (
                                            (roomAvailability[room]?.booked || []).includes(dateStr) ||
                                            (roomAvailability[room]?.pending || []).includes(dateStr)
                                        ) {
                                            isBlocked = true;
                                        }
                                    });
                                    current.setDate(current.getDate() + 1);
                                }

                                if (isBlocked) {
                                    alert("One or more selected dates are already booked or pending for the selected room(s). Please choose another range.");
                                    firstSelectedDate = null;
                                    return;
                                }

                                const nextDay = new Date(rangeEnd);
                                nextDay.setDate(nextDay.getDate() + 1);
                                const rangeEndForCalendar = nextDay.toISOString().split('T')[0];

                        calendar.addEvent({
                            title: 'Selected',
                            start: rangeStart,
                            end: rangeEndForCalendar,
                            color: 'orange'
                        });

                        firstSelectedDate = null;
                    }

                    document.getElementById('proceedToBooking').style.display = 'inline-block';
                },
                eventClick: function(info) {
                    const clickedDate = info.event.start;

                    // Check if the clicked date is part of an existing selection
                    const eventsToRemove = calendar.getEvents().filter(event => {
                        return event.start >= clickedDate && event.title === 'Selected';
                    });

                    if (eventsToRemove.length > 0) {
                        // If there are events to remove, remove them
                        eventsToRemove.forEach(event => event.remove());
                    } else {
                        // If no events to remove, add a new selection for the clicked date
                        calendar.addEvent({
                            title: 'Selected',
                            start: clickedDate,
                            end: clickedDate,
                            color: 'orange'
                        });
                    }
                }
            });
            calendar.render(); // Don't forget to render the calendar

            // Call updateCalendarAvailability to show default available dates
             const selectedRooms = Array.from(document.querySelectorAll('.room-select:checked')).map(cb => cb.value);
            updateCalendarAvailability(selectedRooms);
        }

        function proceedToBooking() {
            // Get selected rooms
            const selectedRooms = Array.from(document.querySelectorAll('.room-checkbox input:checked'))
                .map(checkbox => checkbox.value);

            // Get selected dates (your existing logic)
            const selectedEvents = calendar.getEvents().filter(event => event.title === 'Selected');

            if (selectedEvents.length > 0 && selectedRooms.length > 0) {
                // Store in sessionStorage or pass to your booking form
                sessionStorage.setItem('selectedRooms', JSON.stringify(selectedRooms));
                // Get selected date range from calendar events
                const selectedEvents = calendar.getEvents().filter(event => event.title === 'Selected');
                if (selectedEvents.length > 0) {
                    // For range selection, FullCalendar stores start and end (end is exclusive)
                    const startDate = selectedEvents[0].startStr;
                    // Subtract one day from end (since FullCalendar's end is exclusive)
                    let endDate = selectedEvents[0].end;
                    endDate = new Date(endDate);
                    endDate.setDate(endDate.getDate() - 1);
                    const endDateStr = endDate.toISOString().split('T')[0];

                    sessionStorage.setItem('selectedDates', JSON.stringify({ start: startDate, end: endDateStr }));
                }

                // Hide the calendar modal
                const calendarModal = document.getElementById('calendarModal');
                if (calendarModal) {
                    calendarModal.style.display = 'none';
                    console.log('Calendar modal hidden');
                } else {
                    console.error('Calendar modal not found');
                }

                // Detach and show the booking form
                const bookingForm = document.getElementById('bookingForm');
                if (bookingForm) {
                    // Detach the booking form from the calendar modal
                    bookingForm.parentNode.removeChild(bookingForm);
                    // Append the booking form to the body
                    document.body.appendChild(bookingForm);
                    // --- Reset all checkboxes and days ---
                    const allRoomCheckboxes = document.querySelectorAll('#bookingForm input[type="checkbox"][name="rooms"]');
                    allRoomCheckboxes.forEach(cb => {
                        cb.checked = false;
                    });
                    const allDaysInputs = document.querySelectorAll('#bookingForm input[type="number"][id$="Days"]');
                    allDaysInputs.forEach(input => {
                        input.value = 1;
                    });
                    const selectedRoomsRaw = JSON.parse(sessionStorage.getItem('selectedRooms') || '[]');
                    const selectedDates = JSON.parse(sessionStorage.getItem('selectedDates') || '{}');

                    // Map "Room 1" → "room1"
                    const selectedRooms = selectedRoomsRaw.map(r => r.replace(/\s+/g, '').toLowerCase());

                    // Check the checkboxes for selected rooms
                    selectedRooms.forEach(roomId => {
                        const checkbox = document.querySelector(`#bookingForm input[type="checkbox"][id="${roomId}"]`);
                        if (checkbox) {
                            checkbox.checked = true;
                        }
                    });

                    function getUnavailableDates(roomName) {
                        const room = roomAvailability[roomName];
                        if (!room) return [];
                        return [...(room.booked || []), ...(room.pending || [])];
                    }

                    // --- Booking validation ---
                    function onDaysChange(input) {
                        const roomId = input.id.replace('Days', '');
                        const startDateStr = document.getElementById(`${roomId}StartDate`).value;
                        const numDays = parseInt(input.value, 10);

                        if (!startDateStr || isNaN(numDays)) return;

                        const startDate = new Date(startDateStr);
                        const unavailableDates = getUnavailableDates(roomId);

                        let conflict = false;
                        for (let i = 0; i < numDays; i++) {
                            const checkDate = new Date(startDate);
                            checkDate.setDate(startDate.getDate() + i);
                            const checkDateStr = checkDate.toISOString().split('T')[0];
                            if (unavailableDates.includes(checkDateStr)) {
                                conflict = true;
                                break;
                            }
                        }

                        if (conflict) {
                            alert('Selected days include unavailable (booked or pending) dates. Please choose a different range.');
                            input.value = 1; // Or reset to previous valid value
                        }
                    }
                    // Calculate number of days
                    let numDays = 1;
                    if (selectedDates.start && selectedDates.end) {
                        const start = new Date(selectedDates.start);
                        const end = new Date(selectedDates.end);
                        numDays = Math.round((end - start) / (1000 * 60 * 60 * 24)) + 1;
                    }

                    // Set the number of days for each selected room
                    selectedRooms.forEach(roomId => {
                        const daysInput = document.querySelector(`#bookingForm input[name="${roomId}Days"]`);
                        if (daysInput) {
                            daysInput.value = numDays;
                        }
                        // Set the hidden start date input for this room
                        const startDateInput = document.getElementById(`${roomId}StartDate`);
                        if (startDateInput && selectedDates.start) {
                            startDateInput.value = selectedDates.start; // e.g., "2025-07-02"
                        }
                    });
                    updatePriceSummary();
                    bookingForm.style.display = 'block';
                    bookingForm.scrollIntoView({ behavior: 'smooth' });
                } else {
                    console.error('Booking form not found');
                }
            } else {
                alert('Please select at least one room and date range.');
            }
        }

        // Multi-room selection logic
        document.querySelectorAll('.multi-room-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            // If this button is already active, de-select it (toggle off)
            if (this.classList.contains('active')) {
            this.classList.remove('active');

            // Otherwise, activate this button and set checkboxes as before
            document.querySelectorAll('.room-checkboxes input[type="checkbox"]').forEach(cb => {
            cb.checked = false;
            cb.disabled = false;
            });
            // Optionally, update calendar or other UI here
            // loadRoomAvailability([]);
            return;
            }
            // Get the rooms for this button
            const rooms = this.getAttribute('data-rooms').split(',');

            // Check and disable the relevant checkboxes
            rooms.forEach(roomName => {
            const cb = Array.from(document.querySelectorAll('.room-checkboxes input[type="checkbox"]'))
                .find(cb => cb.value.trim() === roomName.trim());
            if (cb) {
                cb.checked = true;
                cb.disabled = true;
            }
            });

            // Visually indicate the button is active
            document.querySelectorAll('.multi-room-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');

            // Optionally, update calendar or other UI here
            // loadRoomAvailability(rooms);
        });
        });

        // When any single room checkbox is changed, remove multi-room disables
        document.querySelectorAll('.room-checkboxes input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', function() {
            // Remove active state from multi-room buttons
            document.querySelectorAll('.multi-room-btn').forEach(b => b.classList.remove('active'));
            // Enable all checkboxes
            document.querySelectorAll('.room-checkboxes input[type="checkbox"]').forEach(cb2 => cb2.disabled = false);
            // Optionally, update calendar or other UI here
            // const checkedRooms = Array.from(document.querySelectorAll('.room-checkboxes input[type="checkbox"]:checked')).map(cb => cb.value);
            // loadRoomAvailability(checkedRooms);
        });
    });

        // Form functions
        function updateGuestDetails() {
            const guestCount = document.getElementById('guestCount').value;
            const guestDetailsDiv = document.getElementById('guestDetails');

            if (guestCount) {
                let html = '<h3>Guest Details</h3>';
                for (let i = 1; i <= parseInt(guestCount); i++) {
                    html += `
                        <div class="form-row">
                            <div class="form-group">
                                <label for="guest${i}Name">Guest ${i} Name ${i === 1 ? '*' : ''}</label>
                                <input type="text" id="guest${i}Name" name="guest${i}Name" ${i === 1 ? 'required' : ''}>
                            </div>
                            <div class="form-group">
                                <label for="guest${i}Age">Guest ${i} Age</label>
                                <input type="number" id="guest${i}Age" name="guest${i}Age" min="1" max="120">
                            </div>
                        </div>
                    `;
                }
                guestDetailsDiv.innerHTML = html;
            } else {
                guestDetailsDiv.innerHTML = '';
            }
        }

        function toggleRoom(roomId) {
            const roomOption = event.currentTarget;
            const checkbox = document.getElementById(roomId);

            roomOption.classList.toggle('selected');
            checkbox.checked = !checkbox.checked;

            updatePriceSummary();
        }

        function limitDaysInput(input) {
        // Remove non-digit characters
        input.value = input.value.replace(/\D/g, '');
        // Limit to 2 digits
        if (input.value.length > 2) {
            input.value = input.value.slice(0, 2);
        }
        // Enforce min/max
        if (input.value !== '') {
            let val = parseInt(input.value, 10);
            if (val < 1) input.value = 1;
            if (val > 99) input.value = 99;
        }
    }

        function changeQuantity(item, change) {
            addons[item] = Math.max(0, addons[item] + change);
            document.getElementById(`${item}-qty`).textContent = addons[item];
            updatePriceSummary();
        }

        function updatePriceSummary() {
            const summary = document.getElementById('priceSummary');
            let total = 0;

            const roomPrices = {
                room1: 129,
                room2: 99,
                room3: 169
            };

            const selectedRooms = document.querySelectorAll('.room-option input[type="checkbox"]:checked');
            selectedRooms.forEach(room => {
                const roomId = room.id;
                const days = document.getElementById(`${roomId}Days`).value;
                total += roomPrices[roomId] * days;
            });

            // Add addon costs
            total += addons.eggs * 1 + addons.tomatoes * 2;
            if (document.getElementById('pickup').checked) total += 20;
            const pickupCheckbox = document.getElementById('pickup');
            if (pickupCheckbox && pickupCheckbox.checked) {
                total += parseFloat(pickupCheckbox.value);
            }

            const bookingFee = total * 0.5;
            const totalPayableAtBooking = bookingFee; // same as 50%
            const balancePayableBeforeCheckin = total - bookingFee; // remaining 50%

            summary.innerHTML = `
                <p>Subtotal: $${total}</p>
                <p><strong>Total Payable At Booking (50%): $${totalPayableAtBooking}</strong></p>
                <p>Balance Payable Before Check-in (50%): $${balancePayableBeforeCheckin}</p>
            `;
        }

        // Form submission
        document.getElementById('bookingRequestForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // Generate unique 4-digit ID
            const uniqueId = Math.floor(1000 + Math.random() * 9000);

            // Show thank you popup
            document.getElementById('uniqueId').textContent = uniqueId;
            document.getElementById('bookingSummary').innerHTML = `
                <p>Booking request submitted for ${selectedDates.length} dates</p>
                <p>Selected rooms: ${Array.from(document.querySelectorAll('.room-option.selected')).map(r => r.querySelector('h4').textContent).join(', ')}</p>
                <p>Total guests: ${document.getElementById('guestCount').value}</p>
            `;
            document.getElementById('thankYouPopup').style.display = 'flex';

            // Here you would send the actual booking request to your backend
            console.log('Booking request submitted with ID:', uniqueId);
        });

        function closeThankYou() {
            document.getElementById('thankYouPopup').style.display = 'none';
            // Reset form
            document.getElementById('bookingRequestForm').reset();
            document.getElementById('bookingForm').style.display = 'none';
            selectedDates = [];
            addons = { eggs: 0, tomatoes: 0 };
        }

        // Character counter for special requests
        document.getElementById('specialRequests').addEventListener('input', function() {
            const count = this.value.length;
            document.getElementById('charCount').textContent = `${count}/500 characters`;
        });

        // Initialize on load
        window.addEventListener('load', function() {
            setBookingHeroBackground();
        });

        window.addEventListener('resize', setBookingHeroBackground);
    </script>
</body>
</html>
